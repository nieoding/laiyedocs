{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Welcome to MkDocs"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"BasicServices/","text":"\u4ee5root\u8d26\u53f7\u767b\u9646 \u5b89\u88c5\u57fa\u7840\u670d\u52a1 yum install -y epel-release yum install \u2013y wget lrzsz nginx redis yum install \u2013y mysql/mariadb # \u5b89\u88c5\u6570\u636e\u5e93\u5ba2\u6237\u7aef (yum \u2013y install mysql-server) # \u4f7f\u7528\u672c\u5730\u6570\u636e\u5e93\u53e6\u5916\u5b89\u88c5mysql\u670d\u52a1\u7aef \u5173\u95ed\u9632\u706b\u5899 setenforce 0 sed -i 's/^SELINUX=enforcing$/SELINUX=disabled/' /etc/selinux/config systemctl stop firewalld redis\u914d\u7f6e # /etc/redis.conf daemonize yes save bind 127.0.0.1 \u5f00\u542f\u81ea\u542f\u52a8 systemctl start redis systemctl enable redis nginx \u7b49\u540e\u7eed\u5404\u670d\u52a1\u914d\u7f6e\u597d\u518d\u914d\u7f6e \u521b\u5efaworks\u7528\u6237 useradd -m works cd /home/works su works \u4e4b\u540e\u7684\u5e94\u7528\u670d\u52a1\u5fc5\u987b\u653e\u5728/home/works\u4e0b \u5426\u5219\u9700\u8981\u4ece\u4ee3\u7801\u4e2d\u4fee\u6539\u8def\u5f84 nvm wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.4/install.sh | bash nodejs yarn nvm install v6.9.5 node -v npm install -g cnpm yarn \u591a\u4e2anode\u73af\u5883 \u9700\u8981\u624b\u52a8\u5207\u6362v6.9.5 nvm alias default v6.9.5 nvm use v6.9.5 \u62f7\u8d1d\u7ebf\u4e0a\u670d\u52a1\u7684\u6240\u6709\u6587\u4ef6\u5230\u5f53\u524d\u90e8\u7f72\u7684\u4e3b\u673a (/home/works\u76ee\u5f55) \u53ef\u4ee5\u6e05\u9664\u65e7\u7684log find . -regex .*\\.log\\.[0-9]* -print0 | xargs -0 -I {} rm '{}' \u6570\u636e\u5e93\u8fc1\u79fb # \u62f7\u8d1d\u539f\u59cb\u6570\u636e\u5230\u5f53\u524d\u90e8\u7f72\u7684RDS mysqldump ... jingli_knowledge_20190213.sql mysql -h lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn -u root -p create database jingli_knowledge; mysql -h lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn -u root jingli_knowledge -p jingli_knowledge_20190213.sql","title":"\u51c6\u5907\u548c\u57fa\u7840\u670d\u52a1"},{"location":"BasicServices/#redis","text":"# /etc/redis.conf daemonize yes save bind 127.0.0.1 \u5f00\u542f\u81ea\u542f\u52a8 systemctl start redis systemctl enable redis","title":"redis\u914d\u7f6e"},{"location":"BasicServices/#nginx","text":"\u7b49\u540e\u7eed\u5404\u670d\u52a1\u914d\u7f6e\u597d\u518d\u914d\u7f6e","title":"nginx"},{"location":"BasicServices/#works","text":"useradd -m works cd /home/works su works \u4e4b\u540e\u7684\u5e94\u7528\u670d\u52a1\u5fc5\u987b\u653e\u5728/home/works\u4e0b \u5426\u5219\u9700\u8981\u4ece\u4ee3\u7801\u4e2d\u4fee\u6539\u8def\u5f84","title":"\u521b\u5efaworks\u7528\u6237"},{"location":"BasicServices/#nvm","text":"wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.4/install.sh | bash","title":"nvm"},{"location":"BasicServices/#nodejs-yarn","text":"nvm install v6.9.5 node -v npm install -g cnpm yarn \u591a\u4e2anode\u73af\u5883 \u9700\u8981\u624b\u52a8\u5207\u6362v6.9.5 nvm alias default v6.9.5 nvm use v6.9.5","title":"nodejs &amp; yarn"},{"location":"BasicServices/#_1","text":"(/home/works\u76ee\u5f55) \u53ef\u4ee5\u6e05\u9664\u65e7\u7684log find . -regex .*\\.log\\.[0-9]* -print0 | xargs -0 -I {} rm '{}'","title":"\u62f7\u8d1d\u7ebf\u4e0a\u670d\u52a1\u7684\u6240\u6709\u6587\u4ef6\u5230\u5f53\u524d\u90e8\u7f72\u7684\u4e3b\u673a"},{"location":"BasicServices/#_2","text":"# \u62f7\u8d1d\u539f\u59cb\u6570\u636e\u5230\u5f53\u524d\u90e8\u7f72\u7684RDS mysqldump ... jingli_knowledge_20190213.sql mysql -h lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn -u root -p create database jingli_knowledge; mysql -h lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn -u root jingli_knowledge -p jingli_knowledge_20190213.sql","title":"\u6570\u636e\u5e93\u8fc1\u79fb"},{"location":"CRM/","text":"CRM\u76ee\u5f55\u5728 /home/works/apps/crm-jingli/online \u5b89\u88c5\u4f9d\u8d56 cd /home/works/apps/crm-jingli/online cnpm install yarn install npm install -g pm2 \u914d\u7f6e # config/private/mysql.config.js \u914d\u7f6emysql ... production: { host: 'rm-uf62bx6y83t6yws19mo.mysql.rds.aliyuncs.com', port: 3306, user: 'gemii_root', password: 'gemii!@123', supportBigNumbers: true } ... # config/private/redis.config.js \u914d\u7f6eredis ... production: { retry_strategy: retryStrategy, db: '3', host: '127.0.0.1', port: 6379 } ... # config/public/htmlPage href ... links: [ // { rel: 'dns-prefetch', href: 'https://at.alicdn.com' }, // { rel: 'dns-prefetch', href: '//jingli.laiye.com' }, // { rel: 'dns-prefetch', href: '//s1.laiye.com' }, // { rel: 'dns-prefetch', href: '//s3.laiye.com' } // \u5c06href\u66ff\u6362\u6210\u53ef\u8bbf\u95ee\u7684ip\u6216\u57df\u540d { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'} ], ... # .env.production \u914d\u7f6eweb\u670d\u52a1\u57df\u540d ... SERVER_API=http://pubcontent.gemii.cc/ ... # src/server/utils/aliyun.opensearch.utl.js \u914d\u7f6eopensearch ... const host = `opensearch-cn-shanghai.aliyuncs.com` const accessSecret = 'x1VjJtlEJRNTkz1QbA7Z8ieDWJkUOX ' // \u8fd9\u91cc\u8981\u6ce8\u610f' ' const AccessKeyId = 'LTAIZ0kZiSmtZRA3' ... \u6ce8\u610f opensearch accessSecret \u6700\u540e\u9700\u8981\u52a0\u4e2a' '\u5b57\u7b26 \u91cd\u65b0\u6784\u5efa \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 # package.json ... lint-staged : { src/**/*.js : [ prettier-eslint --write , // eslint --max-warnings 10 , // \u5220\u9664\u6b64\u884c git add ] } ... build:prod : { // command : npm run lint npm run clean babel-node tools/scripts/build , // \u4fee\u6539\u6210 command : npm run clean babel-node tools/scripts/build , env : { NODE_ENV : production , MODE : prod } } ... \u5907\u4efd\u4e4b\u524d\u7684\u7f16\u8bd1\u751f\u6210\u7684\u6587\u4ef6 mv build build.bak mv static/jingli-crm/assets static/jingli-crm/assets.bak \u91cd\u7f16 npm run build:prod CRM\u524d\u7aef\u914d\u7f6e sed \u66ff\u6362\u751f\u6210\u524d\u7aef\u6587\u4ef6\u7684\u9759\u6001\u6587\u4ef6\u5f15\u7528\u5730\u5740: cd static/crm-jingli/assets/ sed -i.bak 's/s[0,1].laiye.com/pubcontent.gemii.cc/g' ./* \u82e5\u4fee\u6539\u6709\u8bef\u53ef\u4ee5\u5c06\u6240\u6709bak\u6587\u4ef6\u6279\u91cf\u8fd8\u539f find static/crm-jingli/assets/ -name '*.bak' -print0 | xargs -0 -I {} echo mv -f '{}' '{}' | sed 's/\\.bak$//' | bash \u542f\u52a8CRM\u540e\u7aef\u670d\u52a1 # \u4e4b\u524d\u6709\u8fdb\u7a0b\u6ce8\u518c \u5148\u6e05\u9664 pm2 stop all pm2 delete all # \u4f7f\u7528pm2\u542f\u52a84\u4e2a\u670d\u52a1 pm2 start pord.json pm2 status \u670d\u52a1\u7aef\u53e3\u5206\u522b\u4e3a 8332 8333 nginx\u4ee3\u7406\u914d\u7f6e CRM /etc/nginx/nginx.conf http { ... upstream jingli_online { server 127.0.0.1:8332; server 127.0.0.1:8333; } ... server { ... # node.js crm location / { proxy_pass http://jingli_online; } # static location ~ \\/static\\/.*\\.(js|css|ico|jpg|png|gif|eot|svg|ttf|woff|woff2|map|html) { root /home/works/apps/crm-jingli/online/; expires 7d; access_log off; } ... } ... } \u5c06works\u76ee\u5f55\u8d4b\u4e88nginx\u7528\u6237\u8bbf\u95ee\u6743\u9650 sudo usermod nginx -aG works # nginx\u7528\u6237\u52a0\u5165works group sudo chmod 750 /home/works # \u8d4b\u4e88works\u76ee\u5f55works group\u7684rx\u6743\u9650 systemctl start nginx systemctl enable nginx crm\u5730\u5740: http://pubcontent.gemii.cc \u767b\u5f55\u8d26\u53f7: jingli_laiye jingli@demo","title":"\u77e5\u8bc6\u5e93\u548c\u7ba1\u7406\u5e73\u53f0CRM"},{"location":"CRM/#_1","text":"cd /home/works/apps/crm-jingli/online cnpm install yarn install npm install -g pm2","title":"\u5b89\u88c5\u4f9d\u8d56"},{"location":"CRM/#_2","text":"# config/private/mysql.config.js \u914d\u7f6emysql ... production: { host: 'rm-uf62bx6y83t6yws19mo.mysql.rds.aliyuncs.com', port: 3306, user: 'gemii_root', password: 'gemii!@123', supportBigNumbers: true } ... # config/private/redis.config.js \u914d\u7f6eredis ... production: { retry_strategy: retryStrategy, db: '3', host: '127.0.0.1', port: 6379 } ... # config/public/htmlPage href ... links: [ // { rel: 'dns-prefetch', href: 'https://at.alicdn.com' }, // { rel: 'dns-prefetch', href: '//jingli.laiye.com' }, // { rel: 'dns-prefetch', href: '//s1.laiye.com' }, // { rel: 'dns-prefetch', href: '//s3.laiye.com' } // \u5c06href\u66ff\u6362\u6210\u53ef\u8bbf\u95ee\u7684ip\u6216\u57df\u540d { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'} ], ... # .env.production \u914d\u7f6eweb\u670d\u52a1\u57df\u540d ... SERVER_API=http://pubcontent.gemii.cc/ ... # src/server/utils/aliyun.opensearch.utl.js \u914d\u7f6eopensearch ... const host = `opensearch-cn-shanghai.aliyuncs.com` const accessSecret = 'x1VjJtlEJRNTkz1QbA7Z8ieDWJkUOX ' // \u8fd9\u91cc\u8981\u6ce8\u610f' ' const AccessKeyId = 'LTAIZ0kZiSmtZRA3' ... \u6ce8\u610f opensearch accessSecret \u6700\u540e\u9700\u8981\u52a0\u4e2a' '\u5b57\u7b26","title":"\u914d\u7f6e"},{"location":"CRM/#_3","text":"\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 # package.json ... lint-staged : { src/**/*.js : [ prettier-eslint --write , // eslint --max-warnings 10 , // \u5220\u9664\u6b64\u884c git add ] } ... build:prod : { // command : npm run lint npm run clean babel-node tools/scripts/build , // \u4fee\u6539\u6210 command : npm run clean babel-node tools/scripts/build , env : { NODE_ENV : production , MODE : prod } } ... \u5907\u4efd\u4e4b\u524d\u7684\u7f16\u8bd1\u751f\u6210\u7684\u6587\u4ef6 mv build build.bak mv static/jingli-crm/assets static/jingli-crm/assets.bak \u91cd\u7f16 npm run build:prod","title":"\u91cd\u65b0\u6784\u5efa"},{"location":"CRM/#crm","text":"sed \u66ff\u6362\u751f\u6210\u524d\u7aef\u6587\u4ef6\u7684\u9759\u6001\u6587\u4ef6\u5f15\u7528\u5730\u5740: cd static/crm-jingli/assets/ sed -i.bak 's/s[0,1].laiye.com/pubcontent.gemii.cc/g' ./* \u82e5\u4fee\u6539\u6709\u8bef\u53ef\u4ee5\u5c06\u6240\u6709bak\u6587\u4ef6\u6279\u91cf\u8fd8\u539f find static/crm-jingli/assets/ -name '*.bak' -print0 | xargs -0 -I {} echo mv -f '{}' '{}' | sed 's/\\.bak$//' | bash","title":"CRM\u524d\u7aef\u914d\u7f6e"},{"location":"CRM/#crm_1","text":"# \u4e4b\u524d\u6709\u8fdb\u7a0b\u6ce8\u518c \u5148\u6e05\u9664 pm2 stop all pm2 delete all # \u4f7f\u7528pm2\u542f\u52a84\u4e2a\u670d\u52a1 pm2 start pord.json pm2 status \u670d\u52a1\u7aef\u53e3\u5206\u522b\u4e3a 8332 8333","title":"\u542f\u52a8CRM\u540e\u7aef\u670d\u52a1"},{"location":"CRM/#nginx-crm","text":"/etc/nginx/nginx.conf http { ... upstream jingli_online { server 127.0.0.1:8332; server 127.0.0.1:8333; } ... server { ... # node.js crm location / { proxy_pass http://jingli_online; } # static location ~ \\/static\\/.*\\.(js|css|ico|jpg|png|gif|eot|svg|ttf|woff|woff2|map|html) { root /home/works/apps/crm-jingli/online/; expires 7d; access_log off; } ... } ... }","title":"nginx\u4ee3\u7406\u914d\u7f6e CRM"},{"location":"CRM/#worksnginx","text":"sudo usermod nginx -aG works # nginx\u7528\u6237\u52a0\u5165works group sudo chmod 750 /home/works # \u8d4b\u4e88works\u76ee\u5f55works group\u7684rx\u6743\u9650 systemctl start nginx systemctl enable nginx crm\u5730\u5740: http://pubcontent.gemii.cc \u767b\u5f55\u8d26\u53f7: jingli_laiye jingli@demo","title":"\u5c06works\u76ee\u5f55\u8d4b\u4e88nginx\u7528\u6237\u8bbf\u95ee\u6743\u9650"},{"location":"Platform/","text":"\u77e5\u8bc6\u5e93\u7ba1\u7406\u5e73\u53f0\u8fd0\u884c\u4e8eaws ecs\u670d\u52a1\u5668,\u540c\u65f6\u4f7f\u7528\u4e86\u963f\u91cc\u4e91\u7684\u4e91\u6570\u636e\u5e93\u548c\u5f00\u653e\u641c\u7d22 (OPENSEARCH) aws\u670d\u52a1\u5668\u6240\u5728\u4e91\u670d\u52a1\u5668\u516c\u7f51\u5730\u5740\u4e3a52.80.194.120,\u64cd\u4f5c\u7cfb\u7edf\u4e3aCentOS7\u3002 \u6570\u636e\u5e93\u4e3a\u963f\u91cc\u4e91RDS mysql\u7248\u672cv5.6 appid: rm-uf62bx6y83t6yws19 \u5185\u7f51\u5730\u5740: rm-uf62bx6y83t6yws19.mysql.rds.aliyuncs.com \u5916\u7f51\u5730\u5740: rm-uf62bx6y83t6yws19mo.mysql.rds.aliyuncs.com \u7528\u6237: gemii_root \u5bc6\u7801: gemii!@123 \u77e5\u8bc6\u5e93web\u8bbf\u95ee\u5730\u5740\u4e3a http://pubcontent.gemii.cc/\uff0cweb\u670d\u52a1\u4f7f\u7528node js v6.9.5\u642d\u5efa\uff0c\u8fd0\u884c\u4e8e\u7aef\u53e38332\u30018333\uff0c\u4f7f\u7528nginx\u505a80\u7aef\u53e3\u53cd\u4ee3\uff0c\u4f7f\u7528pm2 v2.5.0\u63a7\u5236\u548c\u76d1\u63a7web\u670d\u52a1\uff0c\u4f7f\u7528\u670d\u52a1\u5668\u672c\u5730redis v3.2.3\u4f5c\u4e3a\u4e34\u65f6key-value\u5b58\u50a8\u5de5\u5177\uff0c\u4f7f\u7528\u7aef\u53e36379\u3001db3\u4f5c\u4e3a\u4f7f\u7528\u5b9e\u4f8b\u3002","title":"\u8fd0\u884c\u73af\u5883"},{"location":"QuestionServices/","text":"\u667a\u80fd\u95ee\u7b54\u7cfb\u7edf\u91c7\u7528\u68c0\u7d22+\u6392\u5e8f\u67b6\u6784\u5b9e\u73b0\u95ee\u9898\u548c\u5019\u9009\u77e5\u8bc6\u70b9\u7684\u8bed\u4e49\u5339\u914d\uff0c\u5176\u67b6\u6784\u793a\u610f\u56fe\u53ca\u5404\u4e2a\u6a21\u5757\u529f\u80fd\u63cf\u8ff0\u5982\u4e0b\u3002 \u6ce8\u610f: \u5404\u670d\u52a1\u5fc5\u987b\u4f7f\u7528\u540d\u4e3aworks\u7684\u7528\u6237 \u7d22\u5f15\u670d\u52a1 /home/works/tools/elasticsearch-5.4.0 \u8be5\u6a21\u5757\u5229\u7528\u7ecf\u5ba1\u6838\u7684\u77e5\u8bc6\u5e93\u6570\u636e\u5efa\u7acb\u5012\u6392\u7d22\u5f15\uff0c\u7528\u4e8e\u53ec\u56de\u95ee\u9898\u7684\u5019\u9009\u56de\u590d\u96c6\u5408\u3002 \u8be5\u6a21\u5757\u53ea\u8d1f\u8d23\u68c0\u7d22\u53ec\u56de\uff0c\u4e0d\u6d89\u53ca\u4e1a\u52a1\u903b\u8f91\uff0c\u9009\u7528\u5f00\u6e90\u641c\u7d22\u5f15\u64ceElasticSearch\u642d\u5efa\uff0c\u5b89\u88c5jieba\u63d2\u4ef6\u4f5c\u4e3a\u9879\u76ee\u4f7f\u7528\u7684\u4e2d\u6587\u5206\u8bcd\u5668\u3002\u901a\u8fc7supervisor\u8fdb\u884c\u7ba1\u7406\u3002 JDK supervisor sudo yum install java-1.8.0-openjdk-devel java -version sudo pip install supervisor \u542f\u52a8es cd ~/tools/elasticsearch-5.4.0 supervisord -c config/sup.kb_es_node.conf supervisorctl -c config/sup.kb_es_node.conf # \u67e5\u770b\u72b6\u6001 \u68c0\u7d22/\u6392\u5e8f\u6a21\u5757 /home/works/online-services/qa-search \u9879\u76ee\u7684\u68c0\u7d22+\u6392\u5e8f\u8fc7\u7a0b\u90fd\u5c01\u88c5\u5728\u8fd9\u4e2a\u6a21\u5757\u4e2d\u3002 \u68c0\u7d22:\u63a5\u6536\u95ee\u9898\u6587\u672c\uff0c\u5b83\u8c03\u7528\u68c0\u7d22\u670d\u52a1\u540e\uff0c\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u505a\u5fc5\u8981\u7684\u5904\u7406\uff0c\u8fd4\u56de\u5019\u9009\u56de\u590d\u96c6\u5408\u3002 \u5177\u4f53\u529f\u80fd\u5305\u62ec\uff1a\u5bf9\u8f93\u5165\u7684\u95ee\u9898\u505a\u5206\u8bcd\u3001\u8bcd\u6027\u8fc7\u6ee4\u3001\u540c\u4e49\u8bcd\u53d8\u6362\u5e76\u6784\u9020ES\u68c0\u7d22\u8868\u8fbe\u5f0f\u8c03\u7528ES\u68c0\u7d22\uff0c\u540c\u65f6\u5bf9\u53ec\u56de\u7ed3\u679c\u8fdb\u884c\u53bb\u91cd\u7b49\u64cd\u4f5c\u3002 \u8be5\u6a21\u5757\u662f\u95ee\u7b54\u7cfb\u7edf\u5185\u90e8\u670d\u52a1,Python\u5f00\u53d1\u7684web service,\u4f9b\u5185\u90e8\u8bbf\u95ee,\u4e0d\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u63a5\u53e3\u3002 \u6392\u5e8f:\u8be5\u6a21\u5757\u8d1f\u8d23\u5bf9\u7531\u68c0\u7d22\u6a21\u5757\u521d\u6b65\u53ec\u56de\u7684\u5019\u9009\u56de\u590d\u96c6\u5408\u505a\u91cd\u6392\u5e8f\uff0c\u6392\u5e8f\u7684\u4e3b\u8981\u4f9d\u636e\u662f\u95ee\u9898\u4e0e\u5019\u9009\u77e5\u8bc6\u70b9\u7684\u8bed\u4e49\u76f8\u5173\u6027\u3002 \u8be5\u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883\uff0c\u4e14\u901a\u8fc7supervisor\u8fdb\u884c\u5b88\u62a4\u3002\u9700\u8981\u5148\u6fc0\u6d3bvirtualenv\u73af\u5883\u5e76\u5b89\u88c5\u597d\u8be5\u6a21\u5757\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9packages\u624d\u80fd\u6b63\u5e38\u542f\u52a8\u3002 \u914d\u7f6e # bin/conf.py g_gemii_db_cfg = { 'dbtype': 'mysql', 'host': 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn', 'port': 3306, 'user': 'root', 'password': 'Rg3UrelC', 'dbname': 'jingli_knowledge', } g_qa_search_api_cfg = { 'host': '127.0.0.1', # \u914d\u7f6e\u6210qa-search\u524d\u7aef\u7684nginx\u670d\u52a1\u5730\u5740 } \u542f\u52a8 cd ~/online-services/qa-search source venv/bin/activate supervisord -c conf/sup.qsearch.conf supervisorctl -c conf/sup.qsearch.conf # \u67e5\u770b\u72b6\u6001 \u7aef\u53e3\u5360\u7528 8131 - 8136 nginx ... upstream py_in_qasearch_jingli { server 127.0.0.1:8131; server 127.0.0.1:8132; server 127.0.0.1:8133; server 127.0.0.1:8134; server 127.0.0.1:8135; server 127.0.0.1:8136; } ... # @hailong: jingli qasearch api (internal api) location /in/nlp/tob/ { proxy_pass http://py_in_qasearch_jingli; } ... \u95ee\u7b54\u63a5\u53e3\u6a21\u5757 /home/works/online-services/qa-coapi-jingli \u8be5\u6a21\u5757\u63d0\u4f9b\u5bf9\u5916\u63a5\u53e3\u670d\u52a1\uff0c\u662fPython\u5f00\u53d1\u7684web service\uff0c\u5177\u4f53\u529f\u80fd\u5305\u62ec\uff1a\u7528\u6237\u9274\u6743\uff0c\u8f93\u5165\u6821\u9a8c\uff0c\u8c03\u7528\u68c0\u7d22/\u6392\u5e8f\u6a21\u5757\uff0c\u751f\u6210topN\u6761\u5019\u9009\u56de\u590d\uff0c\u6309\u63a5\u53e3\u6587\u6863\u683c\u5f0f\u6253\u5305\u8fd4\u56de\u7ed9\u8c03\u7528\u65b9\u3002 \u8be5\u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883\uff0c\u4e14\u901a\u8fc7supervisor\u8fdb\u884c\u5b88\u62a4\u3002\u9700\u8981\u5148\u6fc0\u6d3bvirtualenv\u73af\u5883\u5e76\u5b89\u88c5\u597d\u8be5\u6a21\u5757\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9packages\u624d\u80fd\u6b63\u5e38\u542f\u52a8\u3002 \u914d\u7f6e # bin/conf.py g_gemii_db_cfg = { 'dbtype': 'mysql', 'host': 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn', 'port': 3306, 'user': 'root', 'password': 'Rg3UrelC', 'dbname': 'jingli_knowledge', } \u542f\u52a8 cd ~/online-services/qa-search source venv/bin/activate supervisord -c conf/sup.qa_coapi.conf supervisorctl -c conf/sup.qa_coapi.conf # \u67e5\u770b\u72b6\u6001 \u7aef\u53e3\u5360\u7528 8250 - 8255 nginx ... upstream py_coapi_jingli { server 127.0.0.1:8250; server 127.0.0.1:8251; server 127.0.0.1:8252; server 127.0.0.1:8253; server 127.0.0.1:8254; server 127.0.0.1:8255; } ... # @zhenguo: jingli ai service location /v1/dialog/ { proxy_pass http://py_coapi_jingli; } location /v1/knowledge/ { proxy_pass http://py_coapi_jingli; } location /v1/analytics/ { proxy_pass http://py_coapi_jingli; } location /v1/issue/ { proxy_pass http://py_coapi_jingli; } ... \u77e5\u8bc6\u70b9\u63a8\u8350\u53ca\u63a5\u53e3\u7edf\u8ba1\u6a21\u5757 /home/works/online-services/qa-gemmi-stats \u8be5\u6a21\u5757\u662fPython\u5f00\u53d1\u7684\u811a\u672c\uff0c\u5b8c\u6210\u77e5\u8bc6\u70b9\u63a8\u8350\u3001\u63a5\u53e3\u6570\u636e\u7edf\u8ba1\u7b49\u79bb\u7ebf\u9700\u6c42,\u5177\u4f53\u8d1f\u8d23\u7edf\u8ba1\u6316\u6398\u9ad8\u9891\u4f46\u672a\u6210\u529f\u53ec\u56de\u7684\u77e5\u8bc6\u70b9\uff0c\u5e76\u4e3a\u5176\u63a8\u8350\u76f8\u5173\u7684\u77e5\u8bc6\u70b9\uff0c\u63a8\u8350\u7ed3\u679c\u4f9b\u7ba1\u7406\u4eba\u5458\u5ba1\u6838\u3002\u6b64\u5916\uff0c\u95ee\u7b54\u7cfb\u7edf\u63a5\u53e3\u76f8\u5173\u7684\u7edf\u8ba1\u811a\u672c\uff08\u5982\u63a5\u53e3\u8c03\u7528\u6b21\u6570\u3001\u53ec\u56de\u7387\uff09\u4e5f\u7531\u8be5\u6a21\u5757\u5b9e\u73b0\u3002 \u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883,\u901a\u8fc7crontab\u5b9a\u65f6\u8fd0\u884c(\u8fd0\u884c\u9891\u7387\uff1a1\u6b21/\u5929). \u914d\u7f6e # bin/config.py DB_HOST = 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn' DB_PORT = '3306' DB_USER = 'root' DB_PASSWORD = 'Rg3UrelC' DB_NAME = 'jingli_knowledge' # bin/configure.sh host= lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn port=3306 user= root password= Rg3UrelC database= jingli_knowledge \u81ea\u542f\u52a8 \u5728works\u5e10\u53f7\u7684crontab\u4efb\u52a1\u5217\u8868\u91cc\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e(\u6bcf\u5929\u65e9\u4e0a05:01\u6267\u884c1\u6b21): crontab -e 01 05 * * * cd /home/works/online-services/qa-gemii-stats (source venv/bin/activate sh ./bin/run.sh 2 1 1 cron.log)","title":"\u95ee\u7b54\u670d\u52a1"},{"location":"QuestionServices/#_1","text":"/home/works/tools/elasticsearch-5.4.0 \u8be5\u6a21\u5757\u5229\u7528\u7ecf\u5ba1\u6838\u7684\u77e5\u8bc6\u5e93\u6570\u636e\u5efa\u7acb\u5012\u6392\u7d22\u5f15\uff0c\u7528\u4e8e\u53ec\u56de\u95ee\u9898\u7684\u5019\u9009\u56de\u590d\u96c6\u5408\u3002 \u8be5\u6a21\u5757\u53ea\u8d1f\u8d23\u68c0\u7d22\u53ec\u56de\uff0c\u4e0d\u6d89\u53ca\u4e1a\u52a1\u903b\u8f91\uff0c\u9009\u7528\u5f00\u6e90\u641c\u7d22\u5f15\u64ceElasticSearch\u642d\u5efa\uff0c\u5b89\u88c5jieba\u63d2\u4ef6\u4f5c\u4e3a\u9879\u76ee\u4f7f\u7528\u7684\u4e2d\u6587\u5206\u8bcd\u5668\u3002\u901a\u8fc7supervisor\u8fdb\u884c\u7ba1\u7406\u3002 JDK supervisor sudo yum install java-1.8.0-openjdk-devel java -version sudo pip install supervisor \u542f\u52a8es cd ~/tools/elasticsearch-5.4.0 supervisord -c config/sup.kb_es_node.conf supervisorctl -c config/sup.kb_es_node.conf # \u67e5\u770b\u72b6\u6001","title":"\u7d22\u5f15\u670d\u52a1"},{"location":"QuestionServices/#_2","text":"/home/works/online-services/qa-search \u9879\u76ee\u7684\u68c0\u7d22+\u6392\u5e8f\u8fc7\u7a0b\u90fd\u5c01\u88c5\u5728\u8fd9\u4e2a\u6a21\u5757\u4e2d\u3002 \u68c0\u7d22:\u63a5\u6536\u95ee\u9898\u6587\u672c\uff0c\u5b83\u8c03\u7528\u68c0\u7d22\u670d\u52a1\u540e\uff0c\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u505a\u5fc5\u8981\u7684\u5904\u7406\uff0c\u8fd4\u56de\u5019\u9009\u56de\u590d\u96c6\u5408\u3002 \u5177\u4f53\u529f\u80fd\u5305\u62ec\uff1a\u5bf9\u8f93\u5165\u7684\u95ee\u9898\u505a\u5206\u8bcd\u3001\u8bcd\u6027\u8fc7\u6ee4\u3001\u540c\u4e49\u8bcd\u53d8\u6362\u5e76\u6784\u9020ES\u68c0\u7d22\u8868\u8fbe\u5f0f\u8c03\u7528ES\u68c0\u7d22\uff0c\u540c\u65f6\u5bf9\u53ec\u56de\u7ed3\u679c\u8fdb\u884c\u53bb\u91cd\u7b49\u64cd\u4f5c\u3002 \u8be5\u6a21\u5757\u662f\u95ee\u7b54\u7cfb\u7edf\u5185\u90e8\u670d\u52a1,Python\u5f00\u53d1\u7684web service,\u4f9b\u5185\u90e8\u8bbf\u95ee,\u4e0d\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u63a5\u53e3\u3002 \u6392\u5e8f:\u8be5\u6a21\u5757\u8d1f\u8d23\u5bf9\u7531\u68c0\u7d22\u6a21\u5757\u521d\u6b65\u53ec\u56de\u7684\u5019\u9009\u56de\u590d\u96c6\u5408\u505a\u91cd\u6392\u5e8f\uff0c\u6392\u5e8f\u7684\u4e3b\u8981\u4f9d\u636e\u662f\u95ee\u9898\u4e0e\u5019\u9009\u77e5\u8bc6\u70b9\u7684\u8bed\u4e49\u76f8\u5173\u6027\u3002 \u8be5\u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883\uff0c\u4e14\u901a\u8fc7supervisor\u8fdb\u884c\u5b88\u62a4\u3002\u9700\u8981\u5148\u6fc0\u6d3bvirtualenv\u73af\u5883\u5e76\u5b89\u88c5\u597d\u8be5\u6a21\u5757\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9packages\u624d\u80fd\u6b63\u5e38\u542f\u52a8\u3002 \u914d\u7f6e # bin/conf.py g_gemii_db_cfg = { 'dbtype': 'mysql', 'host': 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn', 'port': 3306, 'user': 'root', 'password': 'Rg3UrelC', 'dbname': 'jingli_knowledge', } g_qa_search_api_cfg = { 'host': '127.0.0.1', # \u914d\u7f6e\u6210qa-search\u524d\u7aef\u7684nginx\u670d\u52a1\u5730\u5740 } \u542f\u52a8 cd ~/online-services/qa-search source venv/bin/activate supervisord -c conf/sup.qsearch.conf supervisorctl -c conf/sup.qsearch.conf # \u67e5\u770b\u72b6\u6001 \u7aef\u53e3\u5360\u7528 8131 - 8136 nginx ... upstream py_in_qasearch_jingli { server 127.0.0.1:8131; server 127.0.0.1:8132; server 127.0.0.1:8133; server 127.0.0.1:8134; server 127.0.0.1:8135; server 127.0.0.1:8136; } ... # @hailong: jingli qasearch api (internal api) location /in/nlp/tob/ { proxy_pass http://py_in_qasearch_jingli; } ...","title":"\u68c0\u7d22/\u6392\u5e8f\u6a21\u5757"},{"location":"QuestionServices/#_3","text":"/home/works/online-services/qa-coapi-jingli \u8be5\u6a21\u5757\u63d0\u4f9b\u5bf9\u5916\u63a5\u53e3\u670d\u52a1\uff0c\u662fPython\u5f00\u53d1\u7684web service\uff0c\u5177\u4f53\u529f\u80fd\u5305\u62ec\uff1a\u7528\u6237\u9274\u6743\uff0c\u8f93\u5165\u6821\u9a8c\uff0c\u8c03\u7528\u68c0\u7d22/\u6392\u5e8f\u6a21\u5757\uff0c\u751f\u6210topN\u6761\u5019\u9009\u56de\u590d\uff0c\u6309\u63a5\u53e3\u6587\u6863\u683c\u5f0f\u6253\u5305\u8fd4\u56de\u7ed9\u8c03\u7528\u65b9\u3002 \u8be5\u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883\uff0c\u4e14\u901a\u8fc7supervisor\u8fdb\u884c\u5b88\u62a4\u3002\u9700\u8981\u5148\u6fc0\u6d3bvirtualenv\u73af\u5883\u5e76\u5b89\u88c5\u597d\u8be5\u6a21\u5757\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9packages\u624d\u80fd\u6b63\u5e38\u542f\u52a8\u3002 \u914d\u7f6e # bin/conf.py g_gemii_db_cfg = { 'dbtype': 'mysql', 'host': 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn', 'port': 3306, 'user': 'root', 'password': 'Rg3UrelC', 'dbname': 'jingli_knowledge', } \u542f\u52a8 cd ~/online-services/qa-search source venv/bin/activate supervisord -c conf/sup.qa_coapi.conf supervisorctl -c conf/sup.qa_coapi.conf # \u67e5\u770b\u72b6\u6001 \u7aef\u53e3\u5360\u7528 8250 - 8255 nginx ... upstream py_coapi_jingli { server 127.0.0.1:8250; server 127.0.0.1:8251; server 127.0.0.1:8252; server 127.0.0.1:8253; server 127.0.0.1:8254; server 127.0.0.1:8255; } ... # @zhenguo: jingli ai service location /v1/dialog/ { proxy_pass http://py_coapi_jingli; } location /v1/knowledge/ { proxy_pass http://py_coapi_jingli; } location /v1/analytics/ { proxy_pass http://py_coapi_jingli; } location /v1/issue/ { proxy_pass http://py_coapi_jingli; } ...","title":"\u95ee\u7b54\u63a5\u53e3\u6a21\u5757"},{"location":"QuestionServices/#_4","text":"/home/works/online-services/qa-gemmi-stats \u8be5\u6a21\u5757\u662fPython\u5f00\u53d1\u7684\u811a\u672c\uff0c\u5b8c\u6210\u77e5\u8bc6\u70b9\u63a8\u8350\u3001\u63a5\u53e3\u6570\u636e\u7edf\u8ba1\u7b49\u79bb\u7ebf\u9700\u6c42,\u5177\u4f53\u8d1f\u8d23\u7edf\u8ba1\u6316\u6398\u9ad8\u9891\u4f46\u672a\u6210\u529f\u53ec\u56de\u7684\u77e5\u8bc6\u70b9\uff0c\u5e76\u4e3a\u5176\u63a8\u8350\u76f8\u5173\u7684\u77e5\u8bc6\u70b9\uff0c\u63a8\u8350\u7ed3\u679c\u4f9b\u7ba1\u7406\u4eba\u5458\u5ba1\u6838\u3002\u6b64\u5916\uff0c\u95ee\u7b54\u7cfb\u7edf\u63a5\u53e3\u76f8\u5173\u7684\u7edf\u8ba1\u811a\u672c\uff08\u5982\u63a5\u53e3\u8c03\u7528\u6b21\u6570\u3001\u53ec\u56de\u7387\uff09\u4e5f\u7531\u8be5\u6a21\u5757\u5b9e\u73b0\u3002 \u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883,\u901a\u8fc7crontab\u5b9a\u65f6\u8fd0\u884c(\u8fd0\u884c\u9891\u7387\uff1a1\u6b21/\u5929). \u914d\u7f6e # bin/config.py DB_HOST = 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn' DB_PORT = '3306' DB_USER = 'root' DB_PASSWORD = 'Rg3UrelC' DB_NAME = 'jingli_knowledge' # bin/configure.sh host= lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn port=3306 user= root password= Rg3UrelC database= jingli_knowledge \u81ea\u542f\u52a8 \u5728works\u5e10\u53f7\u7684crontab\u4efb\u52a1\u5217\u8868\u91cc\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e(\u6bcf\u5929\u65e9\u4e0a05:01\u6267\u884c1\u6b21): crontab -e 01 05 * * * cd /home/works/online-services/qa-gemii-stats (source venv/bin/activate sh ./bin/run.sh 2 1 1 cron.log)","title":"\u77e5\u8bc6\u70b9\u63a8\u8350\u53ca\u63a5\u53e3\u7edf\u8ba1\u6a21\u5757"},{"location":"laiye/","text":"\u6bcd\u5a74\u667a\u80fd\u95ee\u7b54\u7cfb\u7edf\u7ebf\u4e0a\u90e8\u7f72 \u8bf4\u660e\u6587\u6863 \u77e5\u8bc6\u5e93\u548c\u7ba1\u7406\u5e73\u53f0 CRM \u8fd0\u884c\u73af\u5883 \u4e91\u8d44\u6e90 \u77e5\u8bc6\u5e93\u7ba1\u7406\u5e73\u53f0\u8fd0\u884c\u4e8eaws ecs\u670d\u52a1\u5668,\u540c\u65f6\u4f7f\u7528\u4e86\u963f\u91cc\u4e91\u7684\u4e91\u6570\u636e\u5e93\u548c\u5f00\u653e\u641c\u7d22 (OPENSEARCH) \u670d\u52a1\u5668 \u6240\u5728\u4e91\u670d\u52a1\u5668\u516c\u7f51\u5730\u5740\u4e3a52.80.194.120,\u64cd\u4f5c\u7cfb\u7edf\u4e3aCentOS7\u3002 \u4e91\u6570\u636e\u5e93 \u6570\u636e\u5e93\u8f6f\u4ef6\u4e3a\u4e91\u6570\u636e\u5e93mysql v5.6 appid: rm-uf62bx6y83t6yws19 \u5185\u7f51\u5730\u5740: rm-uf62bx6y83t6yws19.mysql.rds.aliyuncs.com \u5916\u7f51\u5730\u5740: rm-uf62bx6y83t6yws19mo.mysql.rds.aliyuncs.com \u7528\u6237: gemii_root \u5bc6\u7801: gemii!@123 \u77e5\u8bc6\u5e93web\u8bbf\u95ee\u5730\u5740\u4e3a http://pubcontent.gemii.cc/\uff0cweb\u670d\u52a1\u4f7f\u7528node js v6.9.5\u642d\u5efa\uff0c\u8fd0\u884c\u4e8e\u7aef\u53e38332\u30018333\uff0c\u4f7f\u7528nginx\u505a80\u7aef\u53e3\u53cd\u4ee3\uff0c\u4f7f\u7528pm2 v2.5.0\u63a7\u5236\u548c\u76d1\u63a7web\u670d\u52a1\uff0c\u4f7f\u7528\u670d\u52a1\u5668\u672c\u5730redis v3.2.3\u4f5c\u4e3a\u4e34\u65f6key-value\u5b58\u50a8\u5de5\u5177\uff0c\u4f7f\u7528\u7aef\u53e36379\u3001db3\u4f5c\u4e3a\u4f7f\u7528\u5b9e\u4f8b\u3002 \u51c6\u5907\u548c\u57fa\u7840\u670d\u52a1 \u4ee5root\u8d26\u53f7\u767b\u9646 \u5b89\u88c5\u57fa\u7840\u670d\u52a1 yum install -y epel-release yum install \u2013y wget lrzsz nginx redis yum install \u2013y mysql/mariadb # \u5b89\u88c5\u6570\u636e\u5e93\u5ba2\u6237\u7aef (yum \u2013y install mysql-server) # \u4f7f\u7528\u672c\u5730\u6570\u636e\u5e93\u53e6\u5916\u5b89\u88c5mysql\u670d\u52a1\u7aef \u5173\u95ed\u9632\u706b\u5899 setenforce 0 sed -i 's/^SELINUX=enforcing$/SELINUX=disabled/' /etc/selinux/config systemctl stop firewalld redis\u914d\u7f6e # /etc/redis.conf daemonize yes save bind 127.0.0.1 \u5f00\u542f\u81ea\u542f\u52a8 systemctl start redis systemctl enable redis nginx\u7b49\u540e\u7eed\u5404\u670d\u52a1\u914d\u7f6e\u597d\u518d\u914d\u7f6e \u521b\u5efaworks\u7528\u6237 useradd -m works cd /home/works su works \u4e4b\u540e\u7684\u5e94\u7528\u670d\u52a1\u5fc5\u987b\u653e\u5728/home/works\u4e0b \u5426\u5219\u9700\u8981\u4ece\u4ee3\u7801\u4e2d\u4fee\u6539\u8def\u5f84 nvm wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.4/install.sh | bash \u62f7\u8d1d\u7ebf\u4e0a\u670d\u52a1\u7684\u6240\u6709\u6587\u4ef6(/home/works\u76ee\u5f55)\u5230\u5f53\u524d\u90e8\u7f72\u7684\u4e3b\u673a \u6e05\u9664\u65e7\u7684log find . -regex .*\\.log\\.[0-9]* -print0 | xargs -0 -I {} rm '{}' nodejs yarn nvm install v6.9.5 node -v \u591a\u4e2anode\u73af\u5883 \u9700\u8981\u624b\u52a8\u5207\u6362v6.9.5 nvm alias default v6.9.5 nvm use v6.9.5 npm install -g cnpm yarn \u6570\u636e\u5e93\u8fc1\u79fb # \u62f7\u8d1d\u539f\u59cb\u6570\u636e\u5230\u5f53\u524d\u90e8\u7f72\u7684RDS mysqldump ... jingli_knowledge_20190213.sql mysql -h lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn -u root -p create database jingli_knowledge; mysql -h lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn -u root jingli_knowledge -p jingli_knowledge_20190213.sql opensearch \u7ed9CRM\u540e\u53f0\u001d\u7684\u67e5\u8be2\u529f\u80fd\u63d0\u4f9b\u63a5\u53e3 \u914d\u7f6eRDS\u8bbf\u95ee\u767d\u540d\u5355 lan: 192.168.0.0/24 gemii: 116.236.177.182 opensearch: 100.104.248.0/24 11.127.123.0/24 11.193.153.11 11.195.170.19 11.196.18.13 11.196.19.20 11.217.213.0/24 11.217.217.0/24 11.217.219.0/24 aws: 52.80.194.120 \u521b\u5efaopensearch\u5e94\u7528 \u53c2\u8003: https://help.aliyun.com/document_detail/29119.html?spm=5176.7946605.1326713.4.70628b6cydTDZx \u6ce8\u610f: \u533a\u57df\u8981\u548cRDS\u76f8\u540c \u9009\u62e9\u9ad8\u7ea7\u7248 \u5165\u95e8\u578b\u6bcf\u4e2a\u533a\u57df\u53ea\u80fd\u7533\u8bf7\u4e24\u4e2a \u6dfb\u52a0RDS\u6570\u636e\u6e90\u914d\u7f6e jingli_knowledge_answer: \u63d0\u4f9b\u7b54\u6848\u548c\u6807\u9898\u7684\u5339\u914d\u641c\u7d22api \u4e3b\u8868 \u8f85\u8868 \u641c\u7d22\u5b57\u6bb5\u6620\u5c04 \u5c5e\u6027\u5b57\u6bb5\u8bbe\u7f6e\u548c\u9ed8\u8ba4\u5c55\u793a\u5b57\u6bb5 \u6570\u636e\u6e90\u4fe1\u606f jingli_question: \u63d0\u4f9b\u5168\u90e8\u5339\u914d\u641c\u7d22api\u548c\u95ee\u9898\u7684\u5339\u914d\u641c\u7d22api \u4e3b\u8868 \u8f85\u8868 \u641c\u7d22\u5b57\u6bb5\u6620\u5c04 \u5c5e\u6027\u5b57\u6bb5\u8bbe\u7f6e\u548c\u9ed8\u8ba4\u5c55\u793a\u5b57\u6bb5 \u6570\u636e\u6e90\u4fe1\u606f \u641c\u7d22\u7ed3\u679c\u98d8\u7ea2\u5c55\u793a \u6ce8\u610f: \u914d\u7f6e\u65f6\u5b57\u6bb5\u540d\u5fc5\u987b\u548c\u793a\u4f8b\u5b8c\u5168\u4e00\u81f4 \u7533\u8bf7access key\u914d\u7f6e\u5230\u670d\u52a1\u4e2d shanghai (gemii\u8d26\u53f7) host: opensearch-cn-shanghai.aliyuncs.com AccessKeyID\uff1a LTAIZ0kZiSmtZRA3 AccessKeySecret\uff1a x1VjJtlEJRNTkz1QbA7Z8ieDWJkUOX beijing (laiye\u8d26\u53f7) host: opensearch-cn-beijing.aliyuncs.com AccessKeyID\uff1a LTAI9vymbGg5dWSw AccessKeySecret: JN5IDWdAdCFCHfQSpkZJNQ0bK2DSzA \u90e8\u7f72CRM CRM\u76ee\u5f55\u5728 /home/works/apps/crm-jingli/online \u5b89\u88c5\u4f9d\u8d56 cd /home/works/apps/crm-jingli/online cnpm install yarn install npm install -g pm2 \u914d\u7f6e # config/private/mysql.config.js \u914d\u7f6emysql ... production: { host: 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn', port: 3306, user: 'root', password: 'Rg3UrelC', supportBigNumbers: true } production: { host: 'rm-uf62bx6y83t6yws19mo.mysql.rds.aliyuncs.com', port: 3306, user: 'gemii_root', password: 'gemii!@123', supportBigNumbers: true } ... rm-uf62bx6y83t6yws19mo.mysql.rds.aliyuncs.com # config/private/redis.config.js \u914d\u7f6eredis ... production: { retry_strategy: retryStrategy, db: '3', host: '127.0.0.1', port: 6379 } ... # config/public/htmlPage href ... links: [ // { rel: 'dns-prefetch', href: 'https://at.alicdn.com' }, // { rel: 'dns-prefetch', href: '//jingli.laiye.com' }, // { rel: 'dns-prefetch', href: '//s1.laiye.com' }, // { rel: 'dns-prefetch', href: '//s3.laiye.com' } // \u5c06href\u66ff\u6362\u6210\u53ef\u8bbf\u95ee\u7684ip\u6216\u57df\u540d { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'} ], ... # .env.production \u914d\u7f6eweb\u670d\u52a1\u57df\u540d ... SERVER_API=http://pubcontent.gemii.cc/ ... # src/server/utils/aliyun.opensearch.utl.js \u914d\u7f6eopensearch ... const host = `opensearch-cn-shanghai.aliyuncs.com` const accessSecret = 'x1VjJtlEJRNTkz1QbA7Z8ieDWJkUOX ' // \u8fd9\u91cc\u8981\u6ce8\u610f' ' const AccessKeyId = 'LTAIZ0kZiSmtZRA3' ... \u6ce8\u610f opensearch accessSecret \u6700\u540e\u9700\u8981\u52a0\u4e2a' '\u5b57\u7b26 \u91cd\u65b0\u6784\u5efa \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 # package.json ... lint-staged : { src/**/*.js : [ prettier-eslint --write , // eslint --max-warnings 10 , // \u5220\u9664\u6b64\u884c git add ] } ... build:prod : { // command : npm run lint npm run clean babel-node tools/scripts/build , // \u4fee\u6539\u6210 command : npm run clean babel-node tools/scripts/build , env : { NODE_ENV : production , MODE : prod } } ... \u5907\u4efd\u4e4b\u524d\u7684\u7f16\u8bd1\u751f\u6210\u7684\u6587\u4ef6 mv build build.bak mv static/jingli-crm/assets static/jingli-crm/assets.bak \u91cd\u7f16 npm run build:prod CRM\u524d\u7aef\u914d\u7f6e sed \u66ff\u6362\u751f\u6210\u524d\u7aef\u6587\u4ef6\u7684\u9759\u6001\u6587\u4ef6\u5f15\u7528\u5730\u5740: cd static/crm-jingli/assets/ sed -i.bak 's/s[0,1].laiye.com/pubcontent.gemii.cc/g' ./* \u82e5\u4fee\u6539\u6709\u8bef\u53ef\u4ee5\u5c06\u6240\u6709bak\u6587\u4ef6\u6279\u91cf\u8fd8\u539f find static/crm-jingli/assets/ -name '*.bak' -print0 | xargs -0 -I {} echo mv -f '{}' '{}' | sed 's/\\.bak$//' | bash \u542f\u52a8CRM\u540e\u7aef\u670d\u52a1 # \u4e4b\u524d\u6709\u8fdb\u7a0b\u6ce8\u518c \u5148\u6e05\u9664 pm2 stop all pm2 delete all # \u4f7f\u7528pm2\u542f\u52a84\u4e2a\u670d\u52a1 pm2 start pord.json pm2 status \u56fe \u670d\u52a1\u7aef\u53e3\u5206\u522b\u4e3a 8332 8333 nginx\u4ee3\u7406\u914d\u7f6e CRM /etc/nginx/nginx.conf http { ... upstream jingli_online { server 127.0.0.1:8332; server 127.0.0.1:8333; } ... server { ... # node.js crm location / { proxy_pass http://jingli_online; } # static location ~ \\/static\\/.*\\.(js|css|ico|jpg|png|gif|eot|svg|ttf|woff|woff2|map|html) { root /home/works/apps/crm-jingli/online/; expires 7d; access_log off; } ... } ... } \u5c06works\u76ee\u5f55\u8d4b\u4e88nginx\u7528\u6237\u8bbf\u95ee\u6743\u9650 sudo usermod nginx -aG works # nginx\u7528\u6237\u52a0\u5165works group sudo chmod 750 /home/works # \u8d4b\u4e88works\u76ee\u5f55works group\u7684rx\u6743\u9650 systemctl start nginx systemctl enable nginx \u767b\u5f55\u5730\u5740: http://pubcontent.gemii.cc \u767b\u5f55\u8d26\u53f7: jingli_laiye jingli@demo \u95ee\u7b54\u670d\u52a1 \u667a\u80fd\u95ee\u7b54\u7cfb\u7edf\u91c7\u7528\u68c0\u7d22+\u6392\u5e8f\u67b6\u6784\u5b9e\u73b0\u95ee\u9898\u548c\u5019\u9009\u77e5\u8bc6\u70b9\u7684\u8bed\u4e49\u5339\u914d\uff0c\u5176\u67b6\u6784\u793a\u610f\u56fe\u53ca\u5404\u4e2a\u6a21\u5757\u529f\u80fd\u63cf\u8ff0\u5982\u4e0b\u3002 \u56fe \u5404\u670d\u52a1\u5fc5\u987b\u4f7f\u7528\u540d\u4e3aworks\u7684\u7528\u6237 \u7d22\u5f15\u670d\u52a1 /home/works/tools/elasticsearch-5.4.0 \u8be5\u6a21\u5757\u5229\u7528\u7ecf\u5ba1\u6838\u7684\u77e5\u8bc6\u5e93\u6570\u636e\u5efa\u7acb\u5012\u6392\u7d22\u5f15\uff0c\u7528\u4e8e\u53ec\u56de\u95ee\u9898\u7684\u5019\u9009\u56de\u590d\u96c6\u5408\u3002 \u8be5\u6a21\u5757\u53ea\u8d1f\u8d23\u68c0\u7d22\u53ec\u56de\uff0c\u4e0d\u6d89\u53ca\u4e1a\u52a1\u903b\u8f91\uff0c\u9009\u7528\u5f00\u6e90\u641c\u7d22\u5f15\u64ceElasticSearch\u642d\u5efa\uff0c\u5b89\u88c5jieba\u63d2\u4ef6\u4f5c\u4e3a\u9879\u76ee\u4f7f\u7528\u7684\u4e2d\u6587\u5206\u8bcd\u5668\u3002\u901a\u8fc7supervisor\u8fdb\u884c\u7ba1\u7406\u3002 JDK supervisor sudo yum install java-1.8.0-openjdk-devel java -version sudo pip install supervisor \u542f\u52a8es cd ~/tools/elasticsearch-5.4.0 supervisord -c config/sup.kb_es_node.conf supervisorctl -c config/sup.kb_es_node.conf # \u67e5\u770b\u72b6\u6001 \u68c0\u7d22/\u6392\u5e8f\u6a21\u5757 /home/works/online-services/qa-search \u9879\u76ee\u7684\u68c0\u7d22+\u6392\u5e8f\u8fc7\u7a0b\u90fd\u5c01\u88c5\u5728\u8fd9\u4e2a\u6a21\u5757\u4e2d\u3002 \u68c0\u7d22:\u8be5\u6a21\u5757\u7684\u8f93\u5165\u662f\u95ee\u9898\u6587\u672c\uff0c\u5b83\u8c03\u7528\u68c0\u7d22\u670d\u52a1\u540e\uff0c\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u505a\u5fc5\u8981\u7684\u5904\u7406\uff0c\u8fd4\u56de\u5019\u9009\u56de\u590d\u96c6\u5408\u3002 \u5177\u4f53\u529f\u80fd\u5305\u62ec\uff1a\u5bf9\u8f93\u5165\u7684\u95ee\u9898\u505a\u5206\u8bcd\u3001\u8bcd\u6027\u8fc7\u6ee4\u3001\u540c\u4e49\u8bcd\u53d8\u6362\u5e76\u6784\u9020ES\u68c0\u7d22\u8868\u8fbe\u5f0f\u8c03\u7528ES\u68c0\u7d22\uff0c\u540c\u65f6\u5bf9\u53ec\u56de\u7ed3\u679c\u8fdb\u884c\u53bb\u91cd\u7b49\u64cd\u4f5c\u3002 \u8be5\u6a21\u5757\u4e3a\u95ee\u7b54\u7cfb\u7edf\u5185\u90e8\u670d\u52a1\uff0c\u662fPython\u5f00\u53d1\u7684web service\uff0c\u4f9b\u5185\u90e8\u8bbf\u95ee,\u4e0d\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u63a5\u53e3\u3002 \u6392\u5e8f:\u8be5\u6a21\u5757\u8d1f\u8d23\u5bf9\u7531\u68c0\u7d22\u6a21\u5757\u521d\u6b65\u53ec\u56de\u7684\u5019\u9009\u56de\u590d\u96c6\u5408\u505a\u91cd\u6392\u5e8f\uff0c\u6392\u5e8f\u7684\u4e3b\u8981\u4f9d\u636e\u662f\u95ee\u9898\u4e0e\u5019\u9009\u77e5\u8bc6\u70b9\u7684\u8bed\u4e49\u76f8\u5173\u6027\u3002 \u8be5\u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883\uff0c\u4e14\u901a\u8fc7supervisor\u8fdb\u884c\u5b88\u62a4\u3002\u6240\u4ee5\uff0c\u9700\u8981\u5148\u6fc0\u6d3bvirtualenv\u73af\u5883\u5e76\u5b89\u88c5\u597d\u8be5\u6a21\u5757\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9packages\u624d\u80fd\u6b63\u5e38\u542f\u52a8\u3002 \u914d\u7f6e # bin/conf.py g_gemii_db_cfg = { 'dbtype': 'mysql', 'host': 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn', 'port': 3306, 'user': 'root', 'password': 'Rg3UrelC', 'dbname': 'jingli_knowledge', } g_qa_search_api_cfg = { 'host': '127.0.0.1', # \u914d\u7f6e\u6210qa-search\u524d\u7aef\u7684nginx\u670d\u52a1\u5730\u5740 } \u542f\u52a8 cd ~/online-services/qa-search source venv/bin/activate supervisord -c conf/sup.qsearch.conf supervisorctl -c conf/sup.qsearch.conf # \u67e5\u770b\u72b6\u6001 \u7aef\u53e3\u5360\u7528 8131 - 8136 nginx ... upstream py_in_qasearch_jingli { server 127.0.0.1:8131; server 127.0.0.1:8132; server 127.0.0.1:8133; server 127.0.0.1:8134; server 127.0.0.1:8135; server 127.0.0.1:8136; } ... # @hailong: jingli qasearch api (internal api) location /in/nlp/tob/ { proxy_pass http://py_in_qasearch_jingli; } ... \u95ee\u7b54\u63a5\u53e3\u6a21\u5757 /home/works/online-services/qa-coapi-jingli \u8be5\u6a21\u5757\u63d0\u4f9b\u5bf9\u5916\u63a5\u53e3\u670d\u52a1\uff0c\u5177\u4f53\u529f\u80fd\u5305\u62ec\uff1a\u7528\u6237\u9274\u6743\uff0c\u8f93\u5165\u6821\u9a8c\uff0c\u8c03\u7528\u68c0\u7d22/\u6392\u5e8f\u6a21\u5757\uff0c\u751f\u6210topN\u6761\u5019\u9009\u56de\u590d\uff0c\u6309\u63a5\u53e3\u6587\u6863\u683c\u5f0f\u6253\u5305\u8fd4\u56de\u7ed9\u8c03\u7528\u65b9\u3002\u8be5\u6a21\u5757\u662fPython\u5f00\u53d1\u7684web service\uff0c\u8c03\u7528\u5185\u90e8\u670d\u52a1\uff0c\u5bf9\u5916\u63d0\u4f9bHTTP\u65b9\u5f0f\u7684\u8bbf\u95ee\u63a5\u53e3\u3002 \u8be5\u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883\uff0c\u4e14\u901a\u8fc7supervisor\u8fdb\u884c\u5b88\u62a4\u3002\u6240\u4ee5\uff0c\u9700\u8981\u5148\u6fc0\u6d3bvirtualenv\u73af\u5883\u5e76\u5b89\u88c5\u597d\u8be5\u6a21\u5757\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9packages\u624d\u80fd\u6b63\u5e38\u542f\u52a8\u3002 \u914d\u7f6e # bin/conf.py g_gemii_db_cfg = { 'dbtype': 'mysql', 'host': 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn', 'port': 3306, 'user': 'root', 'password': 'Rg3UrelC', 'dbname': 'jingli_knowledge', } \u542f\u52a8 cd ~/online-services/qa-search source venv/bin/activate supervisord -c conf/sup.qa_coapi.conf supervisorctl -c conf/sup.qa_coapi.conf # \u67e5\u770b\u72b6\u6001 \u7aef\u53e3\u5360\u7528 8250 - 8255 nginx ... upstream py_coapi_jingli { server 127.0.0.1:8250; server 127.0.0.1:8251; server 127.0.0.1:8252; server 127.0.0.1:8253; server 127.0.0.1:8254; server 127.0.0.1:8255; } ... # @zhenguo: jingli ai service location /v1/dialog/ { proxy_pass http://py_coapi_jingli; } location /v1/knowledge/ { proxy_pass http://py_coapi_jingli; } location /v1/analytics/ { proxy_pass http://py_coapi_jingli; } location /v1/issue/ { proxy_pass http://py_coapi_jingli; } ... \u77e5\u8bc6\u70b9\u63a8\u8350\u53ca\u63a5\u53e3\u7edf\u8ba1\u6a21\u5757 /home/works/online-services/qa-gemmi-stats \u8be5\u6a21\u5757\u8d1f\u8d23\u7edf\u8ba1\u6316\u6398\u9ad8\u9891\u4f46\u672a\u6210\u529f\u53ec\u56de\u7684\u77e5\u8bc6\u70b9\uff0c\u5e76\u4e3a\u5176\u63a8\u8350\u76f8\u5173\u7684\u77e5\u8bc6\u70b9\uff0c\u63a8\u8350\u7ed3\u679c\u4f9b\u7ba1\u7406\u4eba\u5458\u5ba1\u6838\u3002\u6b64\u5916\uff0c\u95ee\u7b54\u7cfb\u7edf\u63a5\u53e3\u76f8\u5173\u7684\u7edf\u8ba1\u811a\u672c\uff08\u5982\u63a5\u53e3\u8c03\u7528\u6b21\u6570\u3001\u53ec\u56de\u7387\uff09\u4e5f\u7531\u8be5\u6a21\u5757\u5b9e\u73b0\u3002 \u8be5\u6a21\u5757\u662fPython\u5f00\u53d1\u7684\u811a\u672c\uff0c\u5b8c\u6210\u77e5\u8bc6\u70b9\u63a8\u8350\u3001\u63a5\u53e3\u6570\u636e\u7edf\u8ba1\u7b49\u79bb\u7ebf\u9700\u6c42,\u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883,\u901a\u8fc7crontab\u5b9a\u65f6\u8fd0\u884c(\u8fd0\u884c\u9891\u7387\uff1a1\u6b21/\u5929).\u5728works\u5e10\u53f7\u7684crontab\u4efb\u52a1\u5217\u8868\u91cc\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e(\u6bcf\u5929\u65e9\u4e0a05:01\u6267\u884c1\u6b21): \u914d\u7f6e # bin/config.py DB_HOST = 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn' DB_PORT = '3306' DB_USER = 'root' DB_PASSWORD = 'Rg3UrelC' DB_NAME = 'jingli_knowledge' # bin/configure.sh host= lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn port=3306 user= root password= Rg3UrelC database= jingli_knowledge \u81ea\u542f\u52a8 crontab -e 01 05 * * * cd /home/works/online-services/qa-gemii-stats (source venv/bin/activate sh ./bin/run.sh 2 1 1 cron.log)","title":"\u6bcd\u5a74\u667a\u80fd\u95ee\u7b54\u7cfb\u7edf\u7ebf\u4e0a\u90e8\u7f72 \u8bf4\u660e\u6587\u6863"},{"location":"laiye/#_1","text":"","title":"\u6bcd\u5a74\u667a\u80fd\u95ee\u7b54\u7cfb\u7edf\u7ebf\u4e0a\u90e8\u7f72 \u8bf4\u660e\u6587\u6863"},{"location":"laiye/#crm","text":"","title":"\u77e5\u8bc6\u5e93\u548c\u7ba1\u7406\u5e73\u53f0 CRM"},{"location":"laiye/#_2","text":"\u4e91\u8d44\u6e90 \u77e5\u8bc6\u5e93\u7ba1\u7406\u5e73\u53f0\u8fd0\u884c\u4e8eaws ecs\u670d\u52a1\u5668,\u540c\u65f6\u4f7f\u7528\u4e86\u963f\u91cc\u4e91\u7684\u4e91\u6570\u636e\u5e93\u548c\u5f00\u653e\u641c\u7d22 (OPENSEARCH) \u670d\u52a1\u5668 \u6240\u5728\u4e91\u670d\u52a1\u5668\u516c\u7f51\u5730\u5740\u4e3a52.80.194.120,\u64cd\u4f5c\u7cfb\u7edf\u4e3aCentOS7\u3002 \u4e91\u6570\u636e\u5e93 \u6570\u636e\u5e93\u8f6f\u4ef6\u4e3a\u4e91\u6570\u636e\u5e93mysql v5.6 appid: rm-uf62bx6y83t6yws19 \u5185\u7f51\u5730\u5740: rm-uf62bx6y83t6yws19.mysql.rds.aliyuncs.com \u5916\u7f51\u5730\u5740: rm-uf62bx6y83t6yws19mo.mysql.rds.aliyuncs.com \u7528\u6237: gemii_root \u5bc6\u7801: gemii!@123 \u77e5\u8bc6\u5e93web\u8bbf\u95ee\u5730\u5740\u4e3a http://pubcontent.gemii.cc/\uff0cweb\u670d\u52a1\u4f7f\u7528node js v6.9.5\u642d\u5efa\uff0c\u8fd0\u884c\u4e8e\u7aef\u53e38332\u30018333\uff0c\u4f7f\u7528nginx\u505a80\u7aef\u53e3\u53cd\u4ee3\uff0c\u4f7f\u7528pm2 v2.5.0\u63a7\u5236\u548c\u76d1\u63a7web\u670d\u52a1\uff0c\u4f7f\u7528\u670d\u52a1\u5668\u672c\u5730redis v3.2.3\u4f5c\u4e3a\u4e34\u65f6key-value\u5b58\u50a8\u5de5\u5177\uff0c\u4f7f\u7528\u7aef\u53e36379\u3001db3\u4f5c\u4e3a\u4f7f\u7528\u5b9e\u4f8b\u3002","title":"\u8fd0\u884c\u73af\u5883"},{"location":"laiye/#_3","text":"\u4ee5root\u8d26\u53f7\u767b\u9646 \u5b89\u88c5\u57fa\u7840\u670d\u52a1 yum install -y epel-release yum install \u2013y wget lrzsz nginx redis yum install \u2013y mysql/mariadb # \u5b89\u88c5\u6570\u636e\u5e93\u5ba2\u6237\u7aef (yum \u2013y install mysql-server) # \u4f7f\u7528\u672c\u5730\u6570\u636e\u5e93\u53e6\u5916\u5b89\u88c5mysql\u670d\u52a1\u7aef \u5173\u95ed\u9632\u706b\u5899 setenforce 0 sed -i 's/^SELINUX=enforcing$/SELINUX=disabled/' /etc/selinux/config systemctl stop firewalld redis\u914d\u7f6e # /etc/redis.conf daemonize yes save bind 127.0.0.1 \u5f00\u542f\u81ea\u542f\u52a8 systemctl start redis systemctl enable redis nginx\u7b49\u540e\u7eed\u5404\u670d\u52a1\u914d\u7f6e\u597d\u518d\u914d\u7f6e \u521b\u5efaworks\u7528\u6237 useradd -m works cd /home/works su works \u4e4b\u540e\u7684\u5e94\u7528\u670d\u52a1\u5fc5\u987b\u653e\u5728/home/works\u4e0b \u5426\u5219\u9700\u8981\u4ece\u4ee3\u7801\u4e2d\u4fee\u6539\u8def\u5f84 nvm wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.4/install.sh | bash","title":"\u51c6\u5907\u548c\u57fa\u7840\u670d\u52a1"},{"location":"laiye/#homeworks","text":"\u6e05\u9664\u65e7\u7684log find . -regex .*\\.log\\.[0-9]* -print0 | xargs -0 -I {} rm '{}' nodejs yarn nvm install v6.9.5 node -v \u591a\u4e2anode\u73af\u5883 \u9700\u8981\u624b\u52a8\u5207\u6362v6.9.5 nvm alias default v6.9.5 nvm use v6.9.5 npm install -g cnpm yarn","title":"\u62f7\u8d1d\u7ebf\u4e0a\u670d\u52a1\u7684\u6240\u6709\u6587\u4ef6(/home/works\u76ee\u5f55)\u5230\u5f53\u524d\u90e8\u7f72\u7684\u4e3b\u673a"},{"location":"laiye/#_4","text":"# \u62f7\u8d1d\u539f\u59cb\u6570\u636e\u5230\u5f53\u524d\u90e8\u7f72\u7684RDS mysqldump ... jingli_knowledge_20190213.sql mysql -h lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn -u root -p create database jingli_knowledge; mysql -h lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn -u root jingli_knowledge -p jingli_knowledge_20190213.sql","title":"\u6570\u636e\u5e93\u8fc1\u79fb"},{"location":"laiye/#opensearch","text":"\u7ed9CRM\u540e\u53f0\u001d\u7684\u67e5\u8be2\u529f\u80fd\u63d0\u4f9b\u63a5\u53e3","title":"opensearch"},{"location":"laiye/#rds","text":"lan: 192.168.0.0/24 gemii: 116.236.177.182 opensearch: 100.104.248.0/24 11.127.123.0/24 11.193.153.11 11.195.170.19 11.196.18.13 11.196.19.20 11.217.213.0/24 11.217.217.0/24 11.217.219.0/24 aws: 52.80.194.120","title":"\u914d\u7f6eRDS\u8bbf\u95ee\u767d\u540d\u5355"},{"location":"laiye/#opensearch_1","text":"\u53c2\u8003: https://help.aliyun.com/document_detail/29119.html?spm=5176.7946605.1326713.4.70628b6cydTDZx \u6ce8\u610f: \u533a\u57df\u8981\u548cRDS\u76f8\u540c \u9009\u62e9\u9ad8\u7ea7\u7248 \u5165\u95e8\u578b\u6bcf\u4e2a\u533a\u57df\u53ea\u80fd\u7533\u8bf7\u4e24\u4e2a","title":"\u521b\u5efaopensearch\u5e94\u7528"},{"location":"laiye/#rds_1","text":"jingli_knowledge_answer: \u63d0\u4f9b\u7b54\u6848\u548c\u6807\u9898\u7684\u5339\u914d\u641c\u7d22api \u4e3b\u8868 \u8f85\u8868 \u641c\u7d22\u5b57\u6bb5\u6620\u5c04 \u5c5e\u6027\u5b57\u6bb5\u8bbe\u7f6e\u548c\u9ed8\u8ba4\u5c55\u793a\u5b57\u6bb5 \u6570\u636e\u6e90\u4fe1\u606f jingli_question: \u63d0\u4f9b\u5168\u90e8\u5339\u914d\u641c\u7d22api\u548c\u95ee\u9898\u7684\u5339\u914d\u641c\u7d22api \u4e3b\u8868 \u8f85\u8868 \u641c\u7d22\u5b57\u6bb5\u6620\u5c04 \u5c5e\u6027\u5b57\u6bb5\u8bbe\u7f6e\u548c\u9ed8\u8ba4\u5c55\u793a\u5b57\u6bb5 \u6570\u636e\u6e90\u4fe1\u606f \u641c\u7d22\u7ed3\u679c\u98d8\u7ea2\u5c55\u793a \u6ce8\u610f: \u914d\u7f6e\u65f6\u5b57\u6bb5\u540d\u5fc5\u987b\u548c\u793a\u4f8b\u5b8c\u5168\u4e00\u81f4","title":"\u6dfb\u52a0RDS\u6570\u636e\u6e90\u914d\u7f6e"},{"location":"laiye/#access-key","text":"shanghai (gemii\u8d26\u53f7) host: opensearch-cn-shanghai.aliyuncs.com AccessKeyID\uff1a LTAIZ0kZiSmtZRA3 AccessKeySecret\uff1a x1VjJtlEJRNTkz1QbA7Z8ieDWJkUOX beijing (laiye\u8d26\u53f7) host: opensearch-cn-beijing.aliyuncs.com AccessKeyID\uff1a LTAI9vymbGg5dWSw AccessKeySecret: JN5IDWdAdCFCHfQSpkZJNQ0bK2DSzA","title":"\u7533\u8bf7access key\u914d\u7f6e\u5230\u670d\u52a1\u4e2d"},{"location":"laiye/#crm_1","text":"CRM\u76ee\u5f55\u5728 /home/works/apps/crm-jingli/online \u5b89\u88c5\u4f9d\u8d56 cd /home/works/apps/crm-jingli/online cnpm install yarn install npm install -g pm2 \u914d\u7f6e # config/private/mysql.config.js \u914d\u7f6emysql ... production: { host: 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn', port: 3306, user: 'root', password: 'Rg3UrelC', supportBigNumbers: true } production: { host: 'rm-uf62bx6y83t6yws19mo.mysql.rds.aliyuncs.com', port: 3306, user: 'gemii_root', password: 'gemii!@123', supportBigNumbers: true } ... rm-uf62bx6y83t6yws19mo.mysql.rds.aliyuncs.com # config/private/redis.config.js \u914d\u7f6eredis ... production: { retry_strategy: retryStrategy, db: '3', host: '127.0.0.1', port: 6379 } ... # config/public/htmlPage href ... links: [ // { rel: 'dns-prefetch', href: 'https://at.alicdn.com' }, // { rel: 'dns-prefetch', href: '//jingli.laiye.com' }, // { rel: 'dns-prefetch', href: '//s1.laiye.com' }, // { rel: 'dns-prefetch', href: '//s3.laiye.com' } // \u5c06href\u66ff\u6362\u6210\u53ef\u8bbf\u95ee\u7684ip\u6216\u57df\u540d { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'}, { rel: 'dns-prefetch', href: '//pubcontent.gemii.cc/'} ], ... # .env.production \u914d\u7f6eweb\u670d\u52a1\u57df\u540d ... SERVER_API=http://pubcontent.gemii.cc/ ... # src/server/utils/aliyun.opensearch.utl.js \u914d\u7f6eopensearch ... const host = `opensearch-cn-shanghai.aliyuncs.com` const accessSecret = 'x1VjJtlEJRNTkz1QbA7Z8ieDWJkUOX ' // \u8fd9\u91cc\u8981\u6ce8\u610f' ' const AccessKeyId = 'LTAIZ0kZiSmtZRA3' ... \u6ce8\u610f opensearch accessSecret \u6700\u540e\u9700\u8981\u52a0\u4e2a' '\u5b57\u7b26 \u91cd\u65b0\u6784\u5efa \u4fee\u6539\u914d\u7f6e\u6587\u4ef6 # package.json ... lint-staged : { src/**/*.js : [ prettier-eslint --write , // eslint --max-warnings 10 , // \u5220\u9664\u6b64\u884c git add ] } ... build:prod : { // command : npm run lint npm run clean babel-node tools/scripts/build , // \u4fee\u6539\u6210 command : npm run clean babel-node tools/scripts/build , env : { NODE_ENV : production , MODE : prod } } ... \u5907\u4efd\u4e4b\u524d\u7684\u7f16\u8bd1\u751f\u6210\u7684\u6587\u4ef6 mv build build.bak mv static/jingli-crm/assets static/jingli-crm/assets.bak \u91cd\u7f16 npm run build:prod CRM\u524d\u7aef\u914d\u7f6e sed \u66ff\u6362\u751f\u6210\u524d\u7aef\u6587\u4ef6\u7684\u9759\u6001\u6587\u4ef6\u5f15\u7528\u5730\u5740: cd static/crm-jingli/assets/ sed -i.bak 's/s[0,1].laiye.com/pubcontent.gemii.cc/g' ./* \u82e5\u4fee\u6539\u6709\u8bef\u53ef\u4ee5\u5c06\u6240\u6709bak\u6587\u4ef6\u6279\u91cf\u8fd8\u539f find static/crm-jingli/assets/ -name '*.bak' -print0 | xargs -0 -I {} echo mv -f '{}' '{}' | sed 's/\\.bak$//' | bash \u542f\u52a8CRM\u540e\u7aef\u670d\u52a1 # \u4e4b\u524d\u6709\u8fdb\u7a0b\u6ce8\u518c \u5148\u6e05\u9664 pm2 stop all pm2 delete all # \u4f7f\u7528pm2\u542f\u52a84\u4e2a\u670d\u52a1 pm2 start pord.json pm2 status \u56fe \u670d\u52a1\u7aef\u53e3\u5206\u522b\u4e3a 8332 8333 nginx\u4ee3\u7406\u914d\u7f6e CRM /etc/nginx/nginx.conf http { ... upstream jingli_online { server 127.0.0.1:8332; server 127.0.0.1:8333; } ... server { ... # node.js crm location / { proxy_pass http://jingli_online; } # static location ~ \\/static\\/.*\\.(js|css|ico|jpg|png|gif|eot|svg|ttf|woff|woff2|map|html) { root /home/works/apps/crm-jingli/online/; expires 7d; access_log off; } ... } ... } \u5c06works\u76ee\u5f55\u8d4b\u4e88nginx\u7528\u6237\u8bbf\u95ee\u6743\u9650 sudo usermod nginx -aG works # nginx\u7528\u6237\u52a0\u5165works group sudo chmod 750 /home/works # \u8d4b\u4e88works\u76ee\u5f55works group\u7684rx\u6743\u9650 systemctl start nginx systemctl enable nginx \u767b\u5f55\u5730\u5740: http://pubcontent.gemii.cc \u767b\u5f55\u8d26\u53f7: jingli_laiye jingli@demo","title":"\u90e8\u7f72CRM"},{"location":"laiye/#_5","text":"\u667a\u80fd\u95ee\u7b54\u7cfb\u7edf\u91c7\u7528\u68c0\u7d22+\u6392\u5e8f\u67b6\u6784\u5b9e\u73b0\u95ee\u9898\u548c\u5019\u9009\u77e5\u8bc6\u70b9\u7684\u8bed\u4e49\u5339\u914d\uff0c\u5176\u67b6\u6784\u793a\u610f\u56fe\u53ca\u5404\u4e2a\u6a21\u5757\u529f\u80fd\u63cf\u8ff0\u5982\u4e0b\u3002 \u56fe \u5404\u670d\u52a1\u5fc5\u987b\u4f7f\u7528\u540d\u4e3aworks\u7684\u7528\u6237","title":"\u95ee\u7b54\u670d\u52a1"},{"location":"laiye/#_6","text":"/home/works/tools/elasticsearch-5.4.0 \u8be5\u6a21\u5757\u5229\u7528\u7ecf\u5ba1\u6838\u7684\u77e5\u8bc6\u5e93\u6570\u636e\u5efa\u7acb\u5012\u6392\u7d22\u5f15\uff0c\u7528\u4e8e\u53ec\u56de\u95ee\u9898\u7684\u5019\u9009\u56de\u590d\u96c6\u5408\u3002 \u8be5\u6a21\u5757\u53ea\u8d1f\u8d23\u68c0\u7d22\u53ec\u56de\uff0c\u4e0d\u6d89\u53ca\u4e1a\u52a1\u903b\u8f91\uff0c\u9009\u7528\u5f00\u6e90\u641c\u7d22\u5f15\u64ceElasticSearch\u642d\u5efa\uff0c\u5b89\u88c5jieba\u63d2\u4ef6\u4f5c\u4e3a\u9879\u76ee\u4f7f\u7528\u7684\u4e2d\u6587\u5206\u8bcd\u5668\u3002\u901a\u8fc7supervisor\u8fdb\u884c\u7ba1\u7406\u3002 JDK supervisor sudo yum install java-1.8.0-openjdk-devel java -version sudo pip install supervisor \u542f\u52a8es cd ~/tools/elasticsearch-5.4.0 supervisord -c config/sup.kb_es_node.conf supervisorctl -c config/sup.kb_es_node.conf # \u67e5\u770b\u72b6\u6001","title":"\u7d22\u5f15\u670d\u52a1"},{"location":"laiye/#_7","text":"/home/works/online-services/qa-search \u9879\u76ee\u7684\u68c0\u7d22+\u6392\u5e8f\u8fc7\u7a0b\u90fd\u5c01\u88c5\u5728\u8fd9\u4e2a\u6a21\u5757\u4e2d\u3002 \u68c0\u7d22:\u8be5\u6a21\u5757\u7684\u8f93\u5165\u662f\u95ee\u9898\u6587\u672c\uff0c\u5b83\u8c03\u7528\u68c0\u7d22\u670d\u52a1\u540e\uff0c\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u505a\u5fc5\u8981\u7684\u5904\u7406\uff0c\u8fd4\u56de\u5019\u9009\u56de\u590d\u96c6\u5408\u3002 \u5177\u4f53\u529f\u80fd\u5305\u62ec\uff1a\u5bf9\u8f93\u5165\u7684\u95ee\u9898\u505a\u5206\u8bcd\u3001\u8bcd\u6027\u8fc7\u6ee4\u3001\u540c\u4e49\u8bcd\u53d8\u6362\u5e76\u6784\u9020ES\u68c0\u7d22\u8868\u8fbe\u5f0f\u8c03\u7528ES\u68c0\u7d22\uff0c\u540c\u65f6\u5bf9\u53ec\u56de\u7ed3\u679c\u8fdb\u884c\u53bb\u91cd\u7b49\u64cd\u4f5c\u3002 \u8be5\u6a21\u5757\u4e3a\u95ee\u7b54\u7cfb\u7edf\u5185\u90e8\u670d\u52a1\uff0c\u662fPython\u5f00\u53d1\u7684web service\uff0c\u4f9b\u5185\u90e8\u8bbf\u95ee,\u4e0d\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1\u63a5\u53e3\u3002 \u6392\u5e8f:\u8be5\u6a21\u5757\u8d1f\u8d23\u5bf9\u7531\u68c0\u7d22\u6a21\u5757\u521d\u6b65\u53ec\u56de\u7684\u5019\u9009\u56de\u590d\u96c6\u5408\u505a\u91cd\u6392\u5e8f\uff0c\u6392\u5e8f\u7684\u4e3b\u8981\u4f9d\u636e\u662f\u95ee\u9898\u4e0e\u5019\u9009\u77e5\u8bc6\u70b9\u7684\u8bed\u4e49\u76f8\u5173\u6027\u3002 \u8be5\u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883\uff0c\u4e14\u901a\u8fc7supervisor\u8fdb\u884c\u5b88\u62a4\u3002\u6240\u4ee5\uff0c\u9700\u8981\u5148\u6fc0\u6d3bvirtualenv\u73af\u5883\u5e76\u5b89\u88c5\u597d\u8be5\u6a21\u5757\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9packages\u624d\u80fd\u6b63\u5e38\u542f\u52a8\u3002 \u914d\u7f6e # bin/conf.py g_gemii_db_cfg = { 'dbtype': 'mysql', 'host': 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn', 'port': 3306, 'user': 'root', 'password': 'Rg3UrelC', 'dbname': 'jingli_knowledge', } g_qa_search_api_cfg = { 'host': '127.0.0.1', # \u914d\u7f6e\u6210qa-search\u524d\u7aef\u7684nginx\u670d\u52a1\u5730\u5740 } \u542f\u52a8 cd ~/online-services/qa-search source venv/bin/activate supervisord -c conf/sup.qsearch.conf supervisorctl -c conf/sup.qsearch.conf # \u67e5\u770b\u72b6\u6001 \u7aef\u53e3\u5360\u7528 8131 - 8136 nginx ... upstream py_in_qasearch_jingli { server 127.0.0.1:8131; server 127.0.0.1:8132; server 127.0.0.1:8133; server 127.0.0.1:8134; server 127.0.0.1:8135; server 127.0.0.1:8136; } ... # @hailong: jingli qasearch api (internal api) location /in/nlp/tob/ { proxy_pass http://py_in_qasearch_jingli; } ...","title":"\u68c0\u7d22/\u6392\u5e8f\u6a21\u5757"},{"location":"laiye/#_8","text":"/home/works/online-services/qa-coapi-jingli \u8be5\u6a21\u5757\u63d0\u4f9b\u5bf9\u5916\u63a5\u53e3\u670d\u52a1\uff0c\u5177\u4f53\u529f\u80fd\u5305\u62ec\uff1a\u7528\u6237\u9274\u6743\uff0c\u8f93\u5165\u6821\u9a8c\uff0c\u8c03\u7528\u68c0\u7d22/\u6392\u5e8f\u6a21\u5757\uff0c\u751f\u6210topN\u6761\u5019\u9009\u56de\u590d\uff0c\u6309\u63a5\u53e3\u6587\u6863\u683c\u5f0f\u6253\u5305\u8fd4\u56de\u7ed9\u8c03\u7528\u65b9\u3002\u8be5\u6a21\u5757\u662fPython\u5f00\u53d1\u7684web service\uff0c\u8c03\u7528\u5185\u90e8\u670d\u52a1\uff0c\u5bf9\u5916\u63d0\u4f9bHTTP\u65b9\u5f0f\u7684\u8bbf\u95ee\u63a5\u53e3\u3002 \u8be5\u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883\uff0c\u4e14\u901a\u8fc7supervisor\u8fdb\u884c\u5b88\u62a4\u3002\u6240\u4ee5\uff0c\u9700\u8981\u5148\u6fc0\u6d3bvirtualenv\u73af\u5883\u5e76\u5b89\u88c5\u597d\u8be5\u6a21\u5757\u4f9d\u8d56\u7684\u7b2c\u4e09\u65b9packages\u624d\u80fd\u6b63\u5e38\u542f\u52a8\u3002 \u914d\u7f6e # bin/conf.py g_gemii_db_cfg = { 'dbtype': 'mysql', 'host': 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn', 'port': 3306, 'user': 'root', 'password': 'Rg3UrelC', 'dbname': 'jingli_knowledge', } \u542f\u52a8 cd ~/online-services/qa-search source venv/bin/activate supervisord -c conf/sup.qa_coapi.conf supervisorctl -c conf/sup.qa_coapi.conf # \u67e5\u770b\u72b6\u6001 \u7aef\u53e3\u5360\u7528 8250 - 8255 nginx ... upstream py_coapi_jingli { server 127.0.0.1:8250; server 127.0.0.1:8251; server 127.0.0.1:8252; server 127.0.0.1:8253; server 127.0.0.1:8254; server 127.0.0.1:8255; } ... # @zhenguo: jingli ai service location /v1/dialog/ { proxy_pass http://py_coapi_jingli; } location /v1/knowledge/ { proxy_pass http://py_coapi_jingli; } location /v1/analytics/ { proxy_pass http://py_coapi_jingli; } location /v1/issue/ { proxy_pass http://py_coapi_jingli; } ...","title":"\u95ee\u7b54\u63a5\u53e3\u6a21\u5757"},{"location":"laiye/#_9","text":"/home/works/online-services/qa-gemmi-stats \u8be5\u6a21\u5757\u8d1f\u8d23\u7edf\u8ba1\u6316\u6398\u9ad8\u9891\u4f46\u672a\u6210\u529f\u53ec\u56de\u7684\u77e5\u8bc6\u70b9\uff0c\u5e76\u4e3a\u5176\u63a8\u8350\u76f8\u5173\u7684\u77e5\u8bc6\u70b9\uff0c\u63a8\u8350\u7ed3\u679c\u4f9b\u7ba1\u7406\u4eba\u5458\u5ba1\u6838\u3002\u6b64\u5916\uff0c\u95ee\u7b54\u7cfb\u7edf\u63a5\u53e3\u76f8\u5173\u7684\u7edf\u8ba1\u811a\u672c\uff08\u5982\u63a5\u53e3\u8c03\u7528\u6b21\u6570\u3001\u53ec\u56de\u7387\uff09\u4e5f\u7531\u8be5\u6a21\u5757\u5b9e\u73b0\u3002 \u8be5\u6a21\u5757\u662fPython\u5f00\u53d1\u7684\u811a\u672c\uff0c\u5b8c\u6210\u77e5\u8bc6\u70b9\u63a8\u8350\u3001\u63a5\u53e3\u6570\u636e\u7edf\u8ba1\u7b49\u79bb\u7ebf\u9700\u6c42,\u6a21\u5757\u7531virtualenv\u63d0\u4f9b\u9694\u79bb\u8fd0\u884c\u73af\u5883,\u901a\u8fc7crontab\u5b9a\u65f6\u8fd0\u884c(\u8fd0\u884c\u9891\u7387\uff1a1\u6b21/\u5929).\u5728works\u5e10\u53f7\u7684crontab\u4efb\u52a1\u5217\u8868\u91cc\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e(\u6bcf\u5929\u65e9\u4e0a05:01\u6267\u884c1\u6b21): \u914d\u7f6e # bin/config.py DB_HOST = 'lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn' DB_PORT = '3306' DB_USER = 'root' DB_PASSWORD = 'Rg3UrelC' DB_NAME = 'jingli_knowledge' # bin/configure.sh host= lizcloud4c.chnh6yhldzwc.rds.cn-north-1.amazonaws.com.cn port=3306 user= root password= Rg3UrelC database= jingli_knowledge \u81ea\u542f\u52a8 crontab -e 01 05 * * * cd /home/works/online-services/qa-gemii-stats (source venv/bin/activate sh ./bin/run.sh 2 1 1 cron.log)","title":"\u77e5\u8bc6\u70b9\u63a8\u8350\u53ca\u63a5\u53e3\u7edf\u8ba1\u6a21\u5757"},{"location":"opensearch/","text":"opensearch\u4e0a\u7684\u5e94\u7528\u7ed9CRM\u540e\u53f0\u001d\u7684\u67e5\u8be2\u529f\u80fd\u63d0\u4f9b\u63a5\u53e3 \u914d\u7f6eRDS\u8bbf\u95ee\u767d\u540d\u5355 lan: 192.168.0.0/24 gemii: 116.236.177.182 opensearch: 100.104.248.0/24 11.127.123.0/24 11.193.153.11 11.195.170.19 11.196.18.13 11.196.19.20 11.217.213.0/24 11.217.217.0/24 11.217.219.0/24 aws: 52.80.194.120 \u521b\u5efaopensearch\u5e94\u7528 \u53c2\u8003: https://help.aliyun.com/document_detail/29119.html?spm=5176.7946605.1326713.4.70628b6cydTDZx \u6ce8\u610f: \u533a\u57df\u8981\u548cRDS\u76f8\u540c \u9009\u62e9\u9ad8\u7ea7\u7248 \u5165\u95e8\u578b\u6bcf\u4e2a\u533a\u57df\u53ea\u80fd\u7533\u8bf7\u4e24\u4e2a \u6dfb\u52a0RDS\u6570\u636e\u6e90\u914d\u7f6e jingli_knowledge_answer \u63d0\u4f9b\u7b54\u6848\u548c\u6807\u9898\u7684\u5339\u914d\u641c\u7d22api \u4e3b\u8868 \u8f85\u8868 \u641c\u7d22\u5b57\u6bb5\u6620\u5c04 \u5c5e\u6027\u5b57\u6bb5\u8bbe\u7f6e\u548c\u9ed8\u8ba4\u5c55\u793a\u5b57\u6bb5 \u6570\u636e\u6e90\u4fe1\u606f jingli_question \u63d0\u4f9b\u5168\u90e8\u5339\u914d\u641c\u7d22api\u548c\u95ee\u9898\u7684\u5339\u914d\u641c\u7d22api \u4e3b\u8868 \u8f85\u8868 \u641c\u7d22\u5b57\u6bb5\u6620\u5c04 \u5c5e\u6027\u5b57\u6bb5\u8bbe\u7f6e\u548c\u9ed8\u8ba4\u5c55\u793a\u5b57\u6bb5 \u6570\u636e\u6e90\u4fe1\u606f \u641c\u7d22\u7ed3\u679c\u98d8\u7ea2\u5c55\u793a \u6ce8\u610f: \u914d\u7f6e\u65f6\u5b57\u6bb5\u540d\u5fc5\u987b\u548c\u793a\u4f8b\u5b8c\u5168\u4e00\u81f4 \u7533\u8bf7access key\u914d\u7f6e\u5230\u670d\u52a1\u4e2d opensearch-shanghai (gemii\u8d26\u53f7) host: opensearch-cn-shanghai.aliyuncs.com AccessKeyID\uff1a LTAIZ0kZiSmtZRA3 AccessKeySecret\uff1a x1VjJtlEJRNTkz1QbA7Z8ieDWJkUOX opensearch-beijing (laiye\u8d26\u53f7) host: opensearch-cn-beijing.aliyuncs.com AccessKeyID\uff1a LTAI9vymbGg5dWSw AccessKeySecret: JN5IDWdAdCFCHfQSpkZJNQ0bK2DSzA","title":"opensearch"},{"location":"opensearch/#rds","text":"lan: 192.168.0.0/24 gemii: 116.236.177.182 opensearch: 100.104.248.0/24 11.127.123.0/24 11.193.153.11 11.195.170.19 11.196.18.13 11.196.19.20 11.217.213.0/24 11.217.217.0/24 11.217.219.0/24 aws: 52.80.194.120","title":"\u914d\u7f6eRDS\u8bbf\u95ee\u767d\u540d\u5355"},{"location":"opensearch/#opensearch","text":"\u53c2\u8003: https://help.aliyun.com/document_detail/29119.html?spm=5176.7946605.1326713.4.70628b6cydTDZx \u6ce8\u610f: \u533a\u57df\u8981\u548cRDS\u76f8\u540c \u9009\u62e9\u9ad8\u7ea7\u7248 \u5165\u95e8\u578b\u6bcf\u4e2a\u533a\u57df\u53ea\u80fd\u7533\u8bf7\u4e24\u4e2a","title":"\u521b\u5efaopensearch\u5e94\u7528"},{"location":"opensearch/#rds_1","text":"","title":"\u6dfb\u52a0RDS\u6570\u636e\u6e90\u914d\u7f6e"},{"location":"opensearch/#jingli_knowledge_answer","text":"\u63d0\u4f9b\u7b54\u6848\u548c\u6807\u9898\u7684\u5339\u914d\u641c\u7d22api \u4e3b\u8868 \u8f85\u8868 \u641c\u7d22\u5b57\u6bb5\u6620\u5c04 \u5c5e\u6027\u5b57\u6bb5\u8bbe\u7f6e\u548c\u9ed8\u8ba4\u5c55\u793a\u5b57\u6bb5 \u6570\u636e\u6e90\u4fe1\u606f","title":"jingli_knowledge_answer"},{"location":"opensearch/#jingli_question","text":"\u63d0\u4f9b\u5168\u90e8\u5339\u914d\u641c\u7d22api\u548c\u95ee\u9898\u7684\u5339\u914d\u641c\u7d22api \u4e3b\u8868 \u8f85\u8868 \u641c\u7d22\u5b57\u6bb5\u6620\u5c04 \u5c5e\u6027\u5b57\u6bb5\u8bbe\u7f6e\u548c\u9ed8\u8ba4\u5c55\u793a\u5b57\u6bb5 \u6570\u636e\u6e90\u4fe1\u606f","title":"jingli_question"},{"location":"opensearch/#_1","text":"\u6ce8\u610f: \u914d\u7f6e\u65f6\u5b57\u6bb5\u540d\u5fc5\u987b\u548c\u793a\u4f8b\u5b8c\u5168\u4e00\u81f4","title":"\u641c\u7d22\u7ed3\u679c\u98d8\u7ea2\u5c55\u793a"},{"location":"opensearch/#access-key","text":"opensearch-shanghai (gemii\u8d26\u53f7) host: opensearch-cn-shanghai.aliyuncs.com AccessKeyID\uff1a LTAIZ0kZiSmtZRA3 AccessKeySecret\uff1a x1VjJtlEJRNTkz1QbA7Z8ieDWJkUOX opensearch-beijing (laiye\u8d26\u53f7) host: opensearch-cn-beijing.aliyuncs.com AccessKeyID\uff1a LTAI9vymbGg5dWSw AccessKeySecret: JN5IDWdAdCFCHfQSpkZJNQ0bK2DSzA","title":"\u7533\u8bf7access key\u914d\u7f6e\u5230\u670d\u52a1\u4e2d"}]}